branches:
  except:
    - /react-.*/
cache: false
language: node_js
sudo: true
node_js:
- 4
env:
  global:
  - CF_API=https://api.cloud.gov
  - CF_USERNAME=deploy-federalist
  - CF_ORGANIZATION=federalist
  - secure:  "JOCdomBbmT85bMwGvuJSpTcI0Z3cFIqi051EHp+g4ti5++DAamb6ah/o7NtR0j/TA7GpLUYGTI61O2InpdrJx3qQI11FE+QmtQpT5I2Ja9zeN3QzG15liQVxyyQAroXMvkhzZuI3AbSSG+TEeXHVLd7mmUdvJdOvT2KKIym2FKFdql6bOa+0//9TMv/JqSV8S50FDqd+zxb3YdxjkRjMWlidGHYFOsau6aAzNwvLNvjQNAJczJZvllTzqITWmL3hLQd1OMdnJFhb+5vo2uQNVJPDtM0b2wQ5hahwhZi+RY3a26yVPwV5zAy8tCIB8PdZN5i0vfBoVqt8J6oNMVv5aih9jgAsjefamTCPBmVPEVmr2vueTOdgCjWeZ7GylK90073mAHPpjX0EA7cu4w3dhD76MLN1Vc5ckfwv+P4s4gT9d2CPftyiUsTj2IeRngVb8xgdyzwCvDzx85lFbP6gvIl8CptEHpfMiHYIWzfm9RD9WkXt3WXFKZoZVTq2665YyzByK6BgcwlXQDTEUdqqqlaLd4tob5UOGhaFDEmM8f7vENz58alFkXgW2KJtEfKmsFYF2fDzV5MyeWuBAXbuEL2pAnjiZcJcSu8jiPpjvlonPxPxjESBtK24lUhdckq5OeElNCywRhUamnWu7UvShXEgQ//9W6OZB/z0941rJtc="
  - CXX=g++-4.8
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
before_deploy:
  - export PATH=$HOME:$PATH
  - travis_retry curl -L -o $HOME/cf.tgz "https://cli.run.pivotal.io/stable?release=linux64-binary&version=6.15.0"
  - tar xzvf $HOME/cf.tgz -C $HOME
  - travis_retry cf install-plugin autopilot -f -r CF-Community
  - npm install
  - npm run build
deploy:
  - provider: script
    script: scripts/deploy-travis.sh
    skip_cleanup: true
    on:
      branch: staging-test
  # - provider: script
  #   script: scripts/deploy-travis.sh
  #   skip_cleanup: true
  #   on:
  #     branch: make_deploys_work_again
notifications:
  slack:
    on_success: never
    on_failure: always
    on_start: never
    on_pull_requests: false
    secure: Eqyu9MVlzDtdFgc/Wv89Br2yuvuh0HRoLMjbpS1KDgZ4si0/aBggV67MaVNiRpEH5Q3Sr01K3M0UfJBU2nJzVlmqkF1zEMVqz0Kox8Qn4EaUSog2DS0X8quU1HAvaqIu+HtwXchcBEhiK1agd79pN3djvr2kGGPdZLqkz4XT+zsRcPgiUcp1oyzCpmqKXv16+7F5RX+pA+CgsawRzOY39qe44HIixxRzJeOxaB+16ccaauqTqxIuBUqlNn1wmlxbYYzTeniF7lJULNMkHcz16pRs6w4vssjUJRsdoKvnyRY33sKKRaWPitzEjAjQNiZeLEym3DG1569xPXjKcvp42Vax5sA20pF92a8E0BQckADSk8wcq3G8Ak58LEg1CvAxp6vQvrcTB1k+/QSg2Y1mzHoEH9d2gebgVZIgn6iqSgHjYxNjCREUhE/SC9pOuaGuJuMhaeCHW/7Ucr0IPwAvzpvKWa1qzDgHLGVlFEI8rTstSnFif0oR7bM7pqdZLEQkpfrE/rV5II19O1c4/hN0JHE6bLNHrULmmYTz/cWqUkuR69OwnifQZGdU06tMrE8u5sdKWbjKMjlRhGHhhsQCW7VQ0NJp7GLJwz9mL8Aq0TH9J4pItGDW++3PfaJpaSHv8UhCCg0GRWEhve2P9JMHldLuij0qR73KjrV2HyER9LA=
